# InformationSecurity-SDES
重庆大学大数据与软件学院-信息安全导论课程实验-SDES算法的实现   
本实验是在胡海波老师指导之下，由朱清杨、邓怡杰完成

## 一、项目结构
<pre>
<code class="tree">
├── README.md                   
├── src
│   ├── src
│   │   └── SDES_.java            - 算法实现
│   │   
│   ├── page                      - 界面设计
│   │    ├── imgs
│   │    │   ├── a.png
│   │    │   └── figure.jpg
│   │    ├── Des.java             - 加解密页面
│   │    └── ResultDialog.java    - 结果显示页面
│   └── test
│       ├── BruteForceTest.java   - 暴力破解测试
│       └── Test_.java            - 基础测试类
└── Main.java                     - 程序入口
</code>
</pre>

## 二、项目说明
### 1. 项目介绍
本项目是根据《信息安全导论》课程第五讲内容实现的对SDES算法的实现，项目呈现形式主要分为加解密页面和结果页面。   
加解密页面默认为加密，需要输入明文和密钥，点击“加密”按钮后，会弹出结果页面，显示加密后的密文。   
也可以选择解密，输入密文和密钥，点击“解密”按钮后，会弹出结果页面，显示解密后的明文。   
![加密操作](ProjectScreenshots%2Fmain_page.png "加密界面")
![可以输入密文和密钥，进行解密操作](ProjectScreenshots%2Fdecipher.png "解密")

在输入明文和密钥后，点击“加密”按钮，会弹出结果页面，显示加密后的密文，如下图所示：
以输入明文“11110000”和密钥“1010101010”为例，加密后得到的结果为：
![encipher_result.png](ProjectScreenshots%2Fencipher_result.png)

在输入密文和密钥后，点击“解密”按钮，会弹出结果页面，显示解密后的明文，如下图所示：
以输入密文“11110000”和密钥“1010101010”为例，解密后得到下面的结果：
![decipher_result.png](ProjectScreenshots%2Fdecipher_result.png)

### 2.输入输出格式
#### i.标准输入
按照实验基本要求的输入格式，输入明文和密钥，格式如下：
明文：8位二进制数   
密钥：10位二进制数

密文：8位二进制数   
密钥：10位二进制数

#### ii.标准输出
按照实验基本要求的输出格式，输出加密后的密文和解密后的明文，格式如下：   
密文：8位数组，每一位存储1位二进制数      
明文：8位数组，每一位存储1位二进制数

#### iii.拓展输入
当明文或者密文输入格式不符合标准输入格式时，都会视为拓展输入，此时将输入作为一个长为n的字符串，n为输入的长度，
将每一位字符先转化为8位的二进制ASCII码，再对8位二进制的ASCII码进行标准格式的加密，再将加密结果视作ASCII码然后转化为字符，
将每一位转化的结果进行组合，得到新的字符串即为密文。
> 但是密钥必须为严格的10位二进制数！
> 由于加密后的得到的ASCII码不可预测，有极大可能出现乱码

拓展输入情形包括：
1. 输入的密文或者明文为二进制数，但是位数不为8位
2. 输入的明文或者密文包含除了0和1以外的数字、字符

拓展输入输出案例如下：
当明文为“1111”，密钥为“1010101010”时，结果为：
![abnormal1.png](ProjectScreenshots%2Fabnormal1.png)
当明文为“helloword”，密钥为“1010101010”时，结果为（乱码）：
![abnormal2.png](ProjectScreenshots%2Fabnormal2.png)
当明文为“yuanshen”，密钥为“1010101010”时，结果为（乱码）：
![abnormal3.png](ProjectScreenshots%2Fabnormal3.png)
当密文为“yFSÆËS”时，密钥为“1111111111”时，结果为：
![abnormal4.png](ProjectScreenshots%2Fabnormal4.png)


### 3.组间测试
本项目已经与魏鹏坤组、方珩组、熊孝宇组、林钰组完成交叉测试并通过

### 4.暴力破解
在src/test/BruteForceTest.java文件中，我们组假设了六组明密文对来进行暴力破解求得密钥，在实验中，我们使用ArrayList来存放明文、密文、
破解得到的第一个密钥以及所消耗的时间，并且我们尝试使用Executors.newFixedThreadPool多线程的方法来提高破解效率，但实际的结果来看，
效率提高的不明显，以下为测试所用的数据以及结果：

<pre>
<code>
第1组明文和密文：
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
第2组明文和密文：
[0, 0, 0, 0, 0, 0, 0, 0]
[0, 0, 0, 0, 0, 0, 0, 0]
第3组明文和密文：
[1, 0, 1, 0, 1, 0, 1, 0]
[1, 0, 1, 0, 1, 0, 1, 0]
第4组明文和密文：
[0, 1, 0, 1, 0, 1, 0, 1]
[0, 1, 0, 1, 0, 1, 0, 1]
第5组明文和密文：
[1, 1, 0, 0, 1, 1, 0, 0]
[1, 1, 0, 0, 1, 1, 0, 0]
第6组明文和密文：
[1, 0, 0, 1, 1, 0, 1, 0]
[1, 1, 1, 0, 1, 1, 1, 1]


暴力破解密钥的时间消耗(微秒)：[441, 37, 872, 495, 2216, 2420]
密钥分别为：
[0, 0, 0, 0, 1, 0, 0, 0, 1, 1]
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0]
[0, 0, 0, 1, 1, 1, 0, 0, 0, 0]
[0, 0, 0, 1, 0, 1, 0, 0, 0, 1]
[1, 0, 0, 0, 1, 0, 0, 0, 0, 1]
[1, 0, 1, 0, 0, 0, 0, 0, 1, 0]
多线程暴力破解消耗的时间（微秒）为：[4264, 339, 599, 657, 1101, 1215]
密钥分别为：
[0, 0, 0, 0, 1, 0, 0, 0, 1, 1]
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0]
[0, 0, 0, 1, 1, 1, 0, 0, 0, 0]
[0, 0, 0, 1, 0, 1, 0, 0, 0, 1]
[1, 0, 0, 0, 1, 0, 0, 0, 0, 1]
[1, 0, 1, 0, 0, 0, 0, 0, 1, 0]
</code> 
</pre>

### 5.封闭测试
在进行暴力破解时，发现同一组明密文对可能存在多个密钥,
即：对于明文空间内任意给定的明文分组，确实存在可能性，即选择不同的密钥，加密可以得到相同的密文。
因此我们使用封闭测试的方法来验证我们的程序的正确性，
在src/test/ClosedTest.java文件中，我们也进行了相关的测试，以下是测试结果：
<pre>
<code>
第1组明文和密文：
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
第2组明文和密文：
[0, 0, 0, 0, 0, 0, 0, 0]
[0, 0, 0, 0, 0, 0, 0, 0]
第3组明文和密文：
[1, 0, 1, 0, 1, 0, 1, 0]
[1, 0, 1, 0, 1, 0, 1, 0]
第4组明文和密文：
[0, 1, 0, 1, 0, 1, 0, 1]
[0, 1, 0, 1, 0, 1, 0, 1]
第5组明文和密文：
[1, 1, 0, 0, 1, 1, 0, 0]
[1, 1, 0, 0, 1, 1, 0, 0]
第6组明文和密文：
[1, 0, 0, 1, 1, 0, 1, 0]
[1, 1, 1, 0, 1, 1, 1, 1]

第0对明密文破解出来的密钥有：
[0, 0, 0, 0, 1, 0, 0, 0, 1, 1]
[0, 0, 1, 1, 0, 1, 1, 0, 1, 0]
[0, 1, 0, 0, 1, 0, 0, 0, 1, 1]
[0, 1, 1, 1, 0, 1, 1, 0, 1, 0]
[1, 0, 0, 0, 0, 0, 0, 1, 0, 0]
[1, 0, 1, 1, 1, 1, 1, 1, 0, 1]
[1, 1, 0, 0, 0, 0, 0, 1, 0, 0]
[1, 1, 1, 1, 1, 1, 1, 1, 0, 1]
第1对明密文破解出来的密钥有：
[0, 0, 0, 0, 0, 0, 0, 0, 1, 0]
[0, 0, 1, 1, 1, 1, 1, 0, 1, 1]
[0, 1, 0, 0, 0, 0, 0, 0, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
[1, 0, 0, 0, 1, 0, 0, 1, 0, 1]
[1, 0, 1, 1, 0, 1, 1, 1, 0, 0]
[1, 1, 0, 0, 1, 0, 0, 1, 0, 1]
[1, 1, 1, 1, 0, 1, 1, 1, 0, 0]
第2对明密文破解出来的密钥有：
[0, 0, 0, 1, 1, 1, 0, 0, 0, 0]
[0, 0, 1, 0, 0, 0, 1, 0, 0, 1]
[0, 1, 0, 1, 1, 1, 0, 0, 0, 0]
[0, 1, 1, 0, 0, 0, 1, 0, 0, 1]
[1, 0, 0, 1, 0, 1, 0, 1, 1, 1]
[1, 0, 1, 0, 1, 0, 1, 1, 1, 0]
[1, 1, 0, 1, 0, 1, 0, 1, 1, 1]
[1, 1, 1, 0, 1, 0, 1, 1, 1, 0]
第3对明密文破解出来的密钥有：
[0, 0, 0, 1, 0, 1, 0, 0, 0, 1]
[0, 0, 1, 0, 1, 0, 1, 0, 0, 0]
[0, 1, 0, 1, 0, 1, 0, 0, 0, 1]
[0, 1, 1, 0, 1, 0, 1, 0, 0, 0]
[1, 0, 0, 1, 1, 1, 0, 1, 1, 0]
[1, 0, 1, 0, 0, 0, 1, 1, 1, 1]
[1, 1, 0, 1, 1, 1, 0, 1, 1, 0]
[1, 1, 1, 0, 0, 0, 1, 1, 1, 1]
第4对明密文破解出来的密钥有：
[1, 0, 0, 0, 1, 0, 0, 0, 0, 1]
[1, 0, 1, 1, 0, 0, 1, 1, 1, 0]
[1, 1, 0, 0, 1, 0, 0, 0, 0, 1]
[1, 1, 1, 1, 0, 0, 1, 1, 1, 0]
第5对明密文破解出来的密钥有：
[1, 0, 1, 0, 0, 0, 0, 0, 1, 0]
[1, 1, 1, 0, 0, 0, 0, 0, 1, 0]

</code>
</pre>

## 三、开发手册

欢迎使用SDES算法加解密工具！本开发手册旨在为开发人员提供对项目结构、源代码、以及扩展和维护项目的指导。

### 1. 项目结构

```plaintext
├── README.md                   
├── src
│   ├── src
│   │   └── SDES_.java            - SDES算法实现
│   │   
│   ├── page                      - 界面设计
│   │   ├── imgs
│   │   │   ├── a.png
│   │   │   └── figure.jpg
│   │   ├── Des.java             - 加解密页面
│   │   └── ResultDialog.java    - 结果显示页面
│   └── test
│       ├── BruteForceTest.java   - 暴力破解测试
│       └── Test_.java            - 基础测试类
└── Main.java                     - 程序入口
```

### 2. SDES算法实现

SDES算法实现位于`src/src/SDES_.java`中。这个文件包含了SDES算法的核心实现，包括加密和解密函数。
#### 1. 常量和置换表
   ##### 1.1 常量
   BLOCK_LENGTH: 分组及密文长度，为8。
   KEY_LENGTH: 密钥长度，为10。
   ##### 1.2 置换表
   P10: 初始置换表，用于对10位密钥进行置换，长度为10。
   P8: 压缩置换表，用于对10位密钥进行置换，长度为8。
   LeftShift1: 1位左移表，用于对密钥进行左移1位，长度为5。
   LeftShift2: 2位左移表，用于对密钥进行左移2位，长度为5。
   IP: 初始置换表，用于对8位输入进行置换，长度为8。
   IP_1: 最终置换表，用于对加密后的8位结果进行置换，长度为8。
   EP_BOX: 拓展置换表，用于对右半部分密钥进行拓展置换，长度为8。
   S_BOX1: S盒置换表1，用于对拓展置换后的密钥进行置换，为4x4的矩阵。
   S_BOX2: S盒置换表2，用于对拓展置换后的密钥进行置换，为4x4的矩阵。
   SP_BOX: 直接置换表，用于对经过S盒置换的密钥进行直接置换，长度为4。
#### 2. SDES_ 类
   SDES_ 类是SDES算法的核心实现类，包含了加密、解密和一系列置换函数。
##### 2.1 置换函数
   P_BOX_substitute: 根据置换表对输入进行置换，通用的置换函数。
   LeftShift: 根据左移表进行左移操作，用于生成子密钥。
   expand_substitute: 对输入的4位密钥进行拓展置换，扩展为8位。
   round_key: 生成加密轮密钥。
##### 2.2 加密和解密函数
   encrypt: SDES加密算法的实现，包括初始置换、子密钥生成、拓展置换、S盒置换、压缩置换和最终置换。
   decrypt: SDES解密算法的实现，与加密算法类似，但子密钥的使用顺序不同。
##### 2.3 加密和解密的字符串输入函数
   encrypt(String key, String plaintext): 以字符串形式输入密钥和明文，返回加密后的密文。
   decrypt(String key, String ciphertext): 以字符串形式输入密钥和密文，返回解密后的明文。
#### 3. 加密过程详解
   初始置换（IP）: 使用初始置换表（IP）对输入的8位明文进行置换，得到置换后的8位序列。

   密钥生成: 使用P10对输入的10位密钥进行置换，然后对得到的结果分别进行1位和2位的左移，生成两个子密钥k1和k2。

   拓展置换（EP-Box）: 对右半部分8位密文进行拓展置换，扩展为12位。

   子密钥加轮: 将拓展置换后的12位结果与k1进行异或运算，得到12位结果。

   S盒置换: 将上一步结果分为两组，分别进行S盒置换。

   压缩置换: 对S盒置换后的结果进行压缩置换，得到4位结果。

   直接置换（SP-Box）: 对压缩置换后的4位结果进行直接置换。

   最终置换（IP^-1）: 将上述结果与初始置换后的4位结果进行异或运算，得到8位加密结果。

#### 4. 解密过程详解
   解密过程与加密过程类似，只是子密钥的使用顺序与加密过程中不同。

### 3. 界面设计

- `Des.java`：加解密页面的实现，包括界面设计和用户交互逻辑。
- `ResultDialog.java`：结果显示页面的实现，用于显示加解密结果。

### 4. 测试

- `BruteForceTest.java`：暴力破解测试，用于测试暴力破解密钥的功能。
- `Test_.java`：基础测试类，用于进行基本的单元测试。

### 5. 编译与运行

1. 使用Java编译器编译项目：
   ```bash
   javac Main.java
   ```

2. 运行项目：
   ```bash
   java Main
   ```

### 6. 扩展与维护

- 如果要扩展功能，可以在现有代码基础上进行修改或添加新的功能模块。
- 如果要改进界面设计，可以修改`Des.java`和`ResultDialog.java`文件。
- 如果要增加新的测试，可以创建新的测试类并在其中添加测试方法。

### 7. 反馈与支持

如果您在开发过程中遇到问题或有任何疑问，欢迎随时联系我们。感谢您的贡献！

祝开发顺利！

## 四、用户指南

欢迎使用SDES算法加解密工具！本工具基于《信息安全导论》课程第五讲内容实现，用于对SDES（Simplified Data Encryption Standard）算法进行加密和解密操作。

### 1. 工具简介

SDES算法是一种简化的数据加密标准，它对输入的8位二进制数据块或者其他类型字符进行加密和解密。本工具提供了图形化界面，让您可以轻松输入明文和密钥，进行加密和解密操作。

### 2. 加密操作

1. 打开程序后，您将看到一个界面，初始状态为加密模式。
2. 在明文输入框中输入8位二进制明文。
3. 在密钥输入框中输入10位二进制密钥。
4. 点击“加密”按钮进行加密操作。
5. 加密结果将在弹出的结果页面中显示。

### 3. 解密操作

1. 打开程序后，您将看到一个界面，初始状态为加密模式。
2. 点击切换为解密模式
3. 在密文输入框中输入8位二进制密文。
4. 在密钥输入框中输入10位二进制密钥。
5. 点击“解密”按钮进行解密操作。
6. 解密结果将在弹出的结果页面中显示。

### 4. 注意事项

- 标准输入下：明文和密钥必须分别为8位和10位二进制数，不得包含除0和1以外的字符。
- 在拓展输入情况下，输入的密文或明文会被视为字符，转化为ASCII码进行处理。但密钥必须仍然是严格的10位二进制数。

### 5. 反馈与支持

如果您遇到任何问题或需要帮助，请随时联系我们。感谢您使用SDES算法加解密工具！

祝您使用愉快！